---
tags: [GAS, Image_Processing, Automation, Legacy_Knowledge]
date: 2026-01-09
source: Legacy_File_Optimization
aliases: [Image_Link_Gen_GAS, ç”»åƒãƒªãƒ³ã‚¯è‡ªå‹•ç”ŸæˆGAS]
---

# [[2026-01-09_ç”»åƒãƒªãƒ³ã‚¯è‡ªå‹•ç”ŸæˆGAS]]
# ç”»åƒãƒªãƒ³ã‚¯è‡ªå‹•ç”ŸæˆGAS

Backlink: [[2026-01-09_ä½œæ¥­ãƒ¡ãƒ¢]] [[00_Deep_Knowledge_Index]]

## Keywords & Tags
#GAS #Image_Processing #Automation #Legacy_Knowledge

---

## ğŸ“… ä½œæˆæ—¥: 2026-01-09_SNSé‹ç”¨è‡ªå‹•åŒ–_å®Œå…¨æ§‹ç¯‰ãƒã‚¤ãƒ–ãƒ«_n8n_VPSç‰ˆ]]

---
```

# Googleãƒ‰ãƒ©ã‚¤ãƒ–ç”»åƒãƒªãƒ³ã‚¯è‡ªå‹•ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

Canvaã§ä½œã£ãŸç”»åƒã‚’Googleãƒ‰ãƒ©ã‚¤ãƒ–ã«å…¥ã‚Œã‚‹ã ã‘ã§ã€**ã€Œãƒ„ãƒ¼ãƒ«ãŒèª­ã¿è¾¼ã‚ã‚‹å½¢å¼ï¼ˆå…¬é–‹URLï¼‰ã€**ã«è‡ªå‹•å¤‰æ›ã—ã¦ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è¨˜å…¥ã™ã‚‹GASã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

ã“ã‚Œã‚’å°å…¥ã™ã‚Œã°ã€**ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã‚’ã„ã¡ã„ã¡æ‰‹å…¥åŠ›ã™ã‚‹æ‰‹é–“ãŒã‚¼ãƒ­**ã«ãªã‚Šã¾ã™ã€‚

---

## âš™ï¸ äº‹å‰æº–å‚™ï¼ˆè¶…é‡è¦ï¼‰

1.  Googleãƒ‰ãƒ©ã‚¤ãƒ–ã«**ã€ŒæŠ•ç¨¿ç”»åƒç”¨ãƒ•ã‚©ãƒ«ãƒ€ã€**ã‚’æ–°è¦ä½œæˆã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼š`SNS_Posts_2026`ï¼‰ã€‚
2.  ãã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’å³ã‚¯ãƒªãƒƒã‚¯ ï¼ å…±æœ‰ ï¼ **ã€Œãƒªãƒ³ã‚¯ã‚’çŸ¥ã£ã¦ã„ã‚‹å…¨å“¡ï¼ˆé–²è¦§è€…ï¼‰ã€**ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚
    *   â€»ã“ã‚Œã‚’è¡Œã‚ãªã„ã¨ã€Pythonãƒ„ãƒ¼ãƒ«ãŒç”»åƒã‚’èª­ã¿è¾¼ã‚ãšã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
3.  ãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ãã€ãƒ–ãƒ©ã‚¦ã‚¶ã®URLãƒãƒ¼ã‹ã‚‰ **ãƒ•ã‚©ãƒ«ãƒ€ID** ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠãã¾ã™ã€‚
    *   `https://drive.google.com/drive/u/0/folders/xxxxxxxxxxxxxxxxxxxx` â† ã“ã® `xxxx` ã®éƒ¨åˆ†

---

## ğŸ’» è¿½åŠ ã™ã‚‹GASã‚³ãƒ¼ãƒ‰

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã€æ—¢å­˜ã® `SNSè‡ªå‹•åŒ–_GASç‰ˆ.js` ã®ä¸€ç•ªä¸‹ã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

```javascript
/**
 * 5. ç”»åƒãƒªãƒ³ã‚¯è‡ªå‹•å–å¾— (Google Drive)
 * æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒã‚’ã€ãƒ•ã‚¡ã‚¤ãƒ«åé †ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®Eåˆ—(Image Prompt)ã¾ãŸã¯æ–°è¦åˆ—ã«è¨˜å…¥ã—ã¾ã™ã€‚
 */
function listingDriveImages() {
  const ui = SpreadsheetApp.getUi();
  
  // 1. ãƒ•ã‚©ãƒ«ãƒ€IDã‚’å…¥åŠ›ã•ã›ã‚‹
  const response = ui.prompt('ç”»åƒãƒ•ã‚©ãƒ«ãƒ€é€£æº', 'Googleãƒ‰ãƒ©ã‚¤ãƒ–ã®ã€Œãƒ•ã‚©ãƒ«ãƒ€IDã€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', ui.ButtonSet.OK_CANCEL);
  if (response.getSelectedButton() != ui.Button.OK) return;
  const folderId = response.getResponseText().trim();
  
  if (!folderId) return;

  try {
    const folder = DriveApp.getFolderById(folderId);
    const files = folder.getFiles();
    const fileList = [];

    // 2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦å–å¾—
    while (files.hasNext()) {
      const file = files.next();
      // ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å¯¾è±¡ (JPG, PNG)
      if (file.getMimeType().includes("image")) {
        fileList.push({
          name: file.getName(),
          // directLinkå½¢å¼ã«å¤‰æ› (UC=User Content export)
          url: "https://drive.google.com/uc?export=view&id=" + file.getId()
        });
      }
    }

    // 3. åå‰é †ã«ã‚½ãƒ¼ãƒˆ (001.jpg, 002.jpg... ã¨ãªã‚‹ã‚ˆã†ã«)
    fileList.sort((a, b) => a.name.localeCompare(b.name));

    if (fileList.length === 0) {
      ui.alert('ã‚¨ãƒ©ãƒ¼', 'ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚', ui.ButtonSet.OK);
      return;
    }

    // 4. ã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã¿
    const sheet = SpreadsheetApp.getActiveSheet();
    const lastRow = sheet.getLastRow();
    
    // ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹è¡Œæ•°åˆ†ã ã‘æ›¸ãè¾¼ã‚€ï¼ˆã¾ãŸã¯ç”»åƒã®æšæ•°åˆ†ï¼‰
    const targetRows = Math.min(lastRow - 1, fileList.length); 
    
    // Eåˆ— (Image URL) ã«æ›¸ãè¾¼ã‚€ã¨ä»®å®š â€»æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã®åˆ—æ§‹æˆã«åˆã‚ã›ã¦èª¿æ•´ã—ã¦ãã ã•ã„
    // æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã§ã¯ Eåˆ—(5åˆ—ç›®) ãŒ Image Prompt ãªã®ã§ã€Fåˆ—(6åˆ—ç›®)ã‚ãŸã‚Šã‚’ä½¿ã†ã‹ã€
    // ã‚ã‚‹ã„ã¯ "Image Prompt" åˆ—ã‚’ "Image URL" ã¨ã—ã¦ä¸Šæ›¸ãåˆ©ç”¨ã™ã‚‹ã‹ã€‚
    // ä»Šå›ã¯ã€ŒFåˆ— (6åˆ—ç›®)ã€ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚
    
    const range = sheet.getRange(2, 6, targetRows, 1); // 2è¡Œç›®, 6åˆ—ç›®ã‹ã‚‰
    const values = [];
    
    for (let i = 0; i < targetRows; i++) {
        values.push([fileList[i].url]);
    }
    
    range.setValues(values);
    
    ui.alert('å®Œäº†', `${targetRows}ä»¶ã®ç”»åƒãƒªãƒ³ã‚¯ã‚’Fåˆ—ã«æ›¸ãè¾¼ã¿ã¾ã—ãŸã€‚\nCSVå‡ºåŠ›ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚`, ui.ButtonSet.OK);

  } catch (e) {
    ui.alert('ã‚¨ãƒ©ãƒ¼', 'ãƒ•ã‚©ãƒ«ãƒ€IDãŒæ­£ã—ããªã„ã‹ã€æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\n' + e.message, ui.ButtonSet.OK);
  }
}

// ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«è¿½åŠ ã™ã‚‹ãŸã‚ã®ä¿®æ­£
// onOpené–¢æ•°ã®ä¸­ã«ä»¥ä¸‹ã®ä¸€è¡Œã‚’è¿½åŠ ã—ã¦ãã ã•ã„ï¼š
// .addItem('5. ç”»åƒãƒªãƒ³ã‚¯å–å¾— (Drive)', 'listingDriveImages')
```

---

## ğŸƒâ€â™‚ï¸ å®Ÿè¡Œæ‰‹é †

1.  **Canva**ã§ä½œã£ãŸç”»åƒï¼ˆ30æšï¼‰ã‚’ã€PCä¸Šã§ `001.jpg`, `002.jpg`... ã¨é€£ç•ªãƒªãƒãƒ¼ãƒ ã™ã‚‹ã€‚
    *   â€»Canvaã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã«ä¸€æ‹¬ã§åå‰ãŒã¤ãã¾ã™ãŒã€é †ç•ªãŒå¤§äº‹ãªã®ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚
2.  Googleãƒ‰ãƒ©ã‚¤ãƒ–ã®**å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€**ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚
3.  ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ **ã€Œ5. ç”»åƒãƒªãƒ³ã‚¯å–å¾— (Drive)ã€** ã‚’å®Ÿè¡Œã€‚
4.  IDã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã‚·ãƒ¼ãƒˆã®æ¨ªã« `https://drive.google.com/...` ã¨ã„ã†URLãŒã‚ºãƒ©ãƒƒã¨å…¥ã‚Šã¾ã™ã€‚
5.  æœ€å¾Œã« **ã€Œ4. CSVæ›¸ãå‡ºã—ã€** ã‚’å®Ÿè¡Œã™ã‚Œã°ã€**ç”»åƒä»˜ãã®è‡ªå‹•æŠ•ç¨¿ç”¨CSV**ãŒå®Œæˆã§ã™ï¼
