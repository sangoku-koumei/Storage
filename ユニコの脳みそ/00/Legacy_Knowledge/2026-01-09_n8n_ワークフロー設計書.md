
# n8n ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆæ›¸
---
tags: [n8n, Workflow, Automation, Design, Legacy_Knowledge]
date: 2026-01-09
source: Legacy_File_Optimization
aliases: [n8n_Workflow_Design, n8nãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆæ›¸]
---

# [[2026-01-09_n8n_ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆæ›¸]]
# n8nãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆæ›¸

Backlink: [[2026-01-09_ä½œæ¥­ãƒ¡ãƒ¢]] [[00_Deep_Knowledge_Index]]

## Keywords & Tags
#n8n #Workflow #Automation #Design #Legacy_Knowledge

---

n8nã«å®Ÿè£…ã™ã‚‹3ã¤ã®ä¸»è¦ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®è©³ç´°è¨­è¨ˆã§ã™ã€‚
VPSä¸Šã®n8nã§ã“ã‚Œã‚‰ã®ãƒ•ãƒ­ãƒ¼ã‚’ç¨¼åƒã•ã›ã‚‹ã“ã¨ã§ã€å®Œå…¨è‡ªå‹•åŒ–ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

---

## ğŸ“… ä½œæˆæ—¥: 2026-01-09. [Core] ã‚¤ãƒ³ã‚¹ã‚¿ & Threads åŒæ™‚æŠ•ç¨¿ãã‚“

æ¯æ—¥æ±ºã¾ã£ãŸæ™‚é–“ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’è¦‹ã«è¡Œãã€æŠ•ç¨¿ãŒã‚ã‚Œã°å®Ÿè¡Œã—ã¾ã™ã€‚

### Trigger
*   **Schedule Trigger**: æ¯æ—¥ 19:00 (JST)

### Flow
1.  **Google Sheets (Read)**
    *   Operation: `Get Many Rows`
    *   Sheet: `Schedule`
    *   Filter: æ—¥ä»˜ãŒã€Œä»Šæ—¥ã€ã®è¡Œã‚’å–å¾—
2.  **IF (Condition)**
    *   æ¡ä»¶: `æŠ•ç¨¿å†…å®¹` ãŒç©ºã§ãªã„ ã‹ã¤ `Status` != "Posted"
3.  **HTTP Request (Instagram)**
    *   Method: `POST`
    *   URL: `https://graph.facebook.com/v19.0/{IG_USER_ID}/media`
    *   Body: `image_url` (from Sheet), `caption` (from Sheet)
    *   **HTTP Request (Publish)**: ä½œæˆã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’å…¬é–‹
4.  **HTTP Request (Threads)**
    *   Method: `POST`
    *   URL: `https://graph.threads.net/v1.0/{THREADS_USER_ID}/threads`
    *   Body: `text` (from Sheet + "ğŸ‘‡ç”»åƒã¯Instaã§!"), `media_type`: "TEXT"
    *   **HTTP Request (Publish)**: Threadsã‚‚å…¬é–‹å‡¦ç†ãŒå¿…è¦
5.  **Google Sheets (Update)**
    *   Operation: `Update Row`
    *   Statusåˆ—ã‚’ "Posted" ã«æ›¸ãæ›ãˆã€‚

---

## ğŸ¤– 2. [Core] å…¨è‡ªå‹•è¿”ä¿¡ãƒœãƒƒãƒˆ (Insta & Threads)

10åˆ†ãŠãã«æ–°ç€ã‚³ãƒ¡ãƒ³ãƒˆãŒãªã„ã‹ãƒ‘ãƒˆãƒ­ãƒ¼ãƒ«ã—ã€AIãŒè¿”ä¿¡ã—ã¾ã™ã€‚

### Trigger
*   **Schedule Trigger**: 10åˆ†ã”ã¨ã«å®Ÿè¡Œ

### Flow (Threads Branch)
1.  **HTTP Request (Get Threads)**
    *   URL: `https://graph.threads.net/v1.0/me/threads?fields=id,text,comments`
    *   ç›´è¿‘ã®æŠ•ç¨¿ã‚’å–å¾—ã€‚
2.  **Item Lists (Split)**
    *   æŠ•ç¨¿ã”ã¨ã«ãƒ«ãƒ¼ãƒ—å‡¦ç†ã€‚
3.  **HTTP Request (Get Comments)**
    *   å„æŠ•ç¨¿ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã€‚
4.  **IF (Filter)**
    *   æ¡ä»¶: `replied` ãƒ•ãƒ©ã‚°ãŒãªã„ï¼ˆè‡ªä½œãƒ­ã‚¸ãƒƒã‚¯ã§åˆ¤å®šï¼‰ AND ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆè‡´
5.  **OpenAI (Chat Model)**
    *   System Prompt: "ã‚ãªãŸã¯è¦ªã—ã¿ã‚„ã™ã„SNSé‹ç”¨æ‹…å½“è€…ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã«çŸ­ãè¿”ä¿¡ã—ã¦ãã ã•ã„ã€‚"
    *   User Message: `{comment_text}`
6.  **HTTP Request (Reply)**
    *   URL: `https://graph.threads.net/v1.0/{comment_id}/replies`
    *   Body: AIã®ç”Ÿæˆãƒ†ã‚­ã‚¹ãƒˆ

â€» Instagram Branchã‚‚åŒæ§˜ã®æ§‹æˆã§ä½œæˆã€‚

---

## ğŸ¨ 3. [Util] DALL-E 3 ç”»åƒç”Ÿæˆ & ãƒ‰ãƒ©ã‚¤ãƒ–ä¿å­˜

GASã‹ã‚‰Webhookã§å‘¼ã³å‡ºã•ã‚Œã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’æ°—ã«ã›ãšç”»åƒã‚’ç”Ÿæˆã—ã¾ã™ã€‚

### Trigger
*   **Webhook**: `POST /generate-image`
    *   Body: `{ "prompt": "çŒ«ã®ç”»åƒ", "row_index": 5 }`

### Flow
1.  **OpenAI (Image Gen)**
    *   Model: `dall-e-3`
    *   Prompt: `{{ $json.prompt }}`
2.  **HTTP Request (Download)**
    *   OpenAIãŒç”Ÿæˆã—ãŸURLã‹ã‚‰ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã€‚
3.  **Google Drive (Upload)**
    *   File Name: `image_{{ $json.row_index }}.png`
    *   Parent Folder: `SNS_Posts_2026` (IDæŒ‡å®š)
    *   **Output**: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã® `webContentLink` ã‚’å–å¾—ã€‚
4.  **Google Sheets (Update)**
    *   ç”Ÿæˆã•ã‚ŒãŸDriveã®URLã‚’ã€æŒ‡å®šè¡Œã®ã€ŒImage URLã€åˆ—ã«æ›¸ãè¾¼ã‚€ã€‚

---

## ğŸ“ VPSã«ç’°å¢ƒæ§‹ç¯‰ã—ãŸã‚‰...

1.  ã“ã‚Œã‚‰ã®è¨­è¨ˆã«åŸºã¥ãã€ãƒãƒ¼ãƒ‰ã‚’ãƒãƒãƒãƒé…ç½®ã™ã‚‹ã ã‘ã§ã™ã€‚
2.  OpenAI, Google, Meta ã® **ã€ŒConnect Credentialsã€** è¨­å®šã‚’è¡Œãˆã°ã€ã™ãã«å‹•ãå‡ºã—ã¾ã™ã€‚

æ¬¡ã¯ã€ã“ã®n8nã‚’å‹•ã‹ã™ãŸã‚ã® **ã€ŒVPSæ§‹ç¯‰ ç°¡æ˜“ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã€** ã‚’ä½œæˆã—ã¾ã™ã€‚
