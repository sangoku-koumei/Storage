---
tags: [Setup, Procedure, Manual, IzumiKyoka, 00]
date: 2026-01-20
source: ãƒ¦ãƒ‹ã‚³ã®è„³ã¿ã/00
aliases: [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †_å…¨è‡ªå‹•é‘‘å®šã‚·ã‚¹ãƒ†ãƒ , Setup_Procedure_Full]
---

[[00_çŸ¥è­˜ãƒãƒƒãƒ—]]

# å…¨è‡ªå‹•é‘‘å®šã‚·ã‚¹ãƒ†ãƒ  ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

## ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

ãŠå®¢æ§˜ãŒGoogleãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰é‘‘å®šä¾é ¼ â†’ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è¨˜éŒ² â†’ GASãŒè‡ªå‹•ã§AI APIå‘¼ã³å‡ºã— â†’ é‘‘å®šæ–‡ç”Ÿæˆ â†’ LINEè‡ªå‹•é€ä¿¡

## ğŸ“‹ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### Step 1ï¼šGoogle Apps Scriptã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

1. Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã
2. ã€Œæ‹¡å¼µæ©Ÿèƒ½ã€â†’ã€ŒApps Scriptã€ã‚’é–‹ã
3. `GAS_ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ.gs`ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘
4. **é‡è¦ï¼š** å„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé–¢æ•°ï¼ˆ`getPromptPaid10000()`ãªã©ï¼‰ã«ã€å¯¾å¿œã™ã‚‹txtãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã‚‹
5. ä¿å­˜ã—ã¦å®Ÿè¡Œï¼š`importPrompts()`
6. æ¨©é™ã‚’è¨±å¯
7. å®Œäº†ï¼ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®`ai_prompts`ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã‚Šã¾ã™

### Step 2ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®è¿½åŠ ãƒ»ä¿®æ­£

#### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿½åŠ ã™ã‚‹å ´åˆ
```javascript
{
  prompt_id: 'prompt_new_product',
  prompt_type: 'love_reading',
  product_id: 'NEW_PRODUCT_ID',
  title: 'æ–°å•†å“ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ',
  content: getPromptNewProduct(), // æ–°ã—ã„é–¢æ•°ã‚’ä½œæˆ
  active: true,
  sort_order: 6,
  notes: 'æ–°å•†å“ã®èª¬æ˜'
}
```

#### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä¿®æ­£ã™ã‚‹å ´åˆ
1. GASã®è©²å½“é–¢æ•°ï¼ˆä¾‹ï¼š`getPromptFree001()`ï¼‰ã‚’ç·¨é›†
2. `importPrompts()`ã‚’å†å®Ÿè¡Œ
3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™

### Step 3ï¼šAI APIé€£æºï¼ˆChatGPT / Claudeï¼‰

#### ChatGPT APIã®å ´åˆ

```javascript
function callChatGPT(prompt, customerData) {
  const apiKey = PropertiesService.getScriptProperties().getProperty('OPENAI_API_KEY');
  const url = 'https://api.openai.com/v1/chat/completions';
  
  // ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã«ç½®æ›
  const filledPrompt = fillPromptWithData(prompt, customerData);
  
  const payload = {
    model: 'gpt-4',
    messages: [
      {role: 'user', content: filledPrompt}
    ],
    temperature: 0.7,
    max_tokens: 4000
  };
  
  const options = {
    method: 'post',
    contentType: 'application/json',
    headers: {
      'Authorization': 'Bearer ' + apiKey
    },
    payload: JSON.stringify(payload)
  };
  
  const response = UrlFetchApp.fetch(url, options);
  const result = JSON.parse(response.getContentText());
  
  return result.choices[0].message.content;
}
```

#### Claude APIã®å ´åˆ

```javascript
function callClaude(prompt, customerData) {
  const apiKey = PropertiesService.getScriptProperties().getProperty('CLAUDE_API_KEY');
  const url = 'https://api.anthropic.com/v1/messages';
  
  // ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã«ç½®æ›
  const filledPrompt = fillPromptWithData(prompt, customerData);
  
  const payload = {
    model: 'claude-3-5-sonnet-20241022',
    max_tokens: 8000,
    messages: [
      {role: 'user', content: filledPrompt}
    ]
  };
  
  const options = {
    method: 'post',
    contentType: 'application/json',
    headers: {
      'x-api-key': apiKey,
      'anthropic-version': '2023-06-01'
    },
    payload: JSON.stringify(payload)
  };
  
  const response = UrlFetchApp.fetch(url, options);
  const result = JSON.parse(response.getContentText());
  
  return result.content[0].text;
}
```

#### ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ç½®æ›ã™ã‚‹é–¢æ•°

```javascript
function fillPromptWithData(prompt, customerData) {
  let filledPrompt = prompt;
  
  // {é¡§å®¢å}ãªã©ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã«ç½®æ›
  filledPrompt = filledPrompt.replace(/{é¡§å®¢å}/g, customerData.name || '');
  filledPrompt = filledPrompt.replace(/{ç”Ÿå¹´æœˆæ—¥}/g, customerData.birthdate || '');
  filledPrompt = filledPrompt.replace(/{æ€§åˆ¥}/g, customerData.gender || '');
  filledPrompt = filledPrompt.replace(/{é¸æŠè‚¢}/g, customerData.choice || '');
  filledPrompt = filledPrompt.replace(/{å½¼ã®åå‰}/g, customerData.hisName || '');
  filledPrompt = filledPrompt.replace(/{å½¼ã®ç”Ÿå¹´æœˆæ—¥}/g, customerData.hisBirthdate || '');
  filledPrompt = filledPrompt.replace(/{æ‹æ„›çŠ¶æ³}/g, customerData.situation || '');
  filledPrompt = filledPrompt.replace(/{æ‚©ã¿ã®è©³ç´°}/g, customerData.problem || '');
  filledPrompt = filledPrompt.replace(/{è³ªå•äº‹é …}/g, customerData.question || '');
  
  // ä»–ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚‚åŒæ§˜ã«è¿½åŠ 
  
  return filledPrompt;
}
```

### Step 4ï¼šè‡ªå‹•é‘‘å®šã®ãƒ¡ã‚¤ãƒ³é–¢æ•°

```javascript
function autoGenerateReading(orderId) {
  // 1. æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const orderData = getOrderData(orderId);
  
  // 2. å•†å“IDã‹ã‚‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å–å¾—
  const promptData = getPromptByProductId(orderData.productId);
  
  if (!promptData) {
    Logger.log('ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + orderData.productId);
    return;
  }
  
  // 3. AI APIã‚’å‘¼ã³å‡ºã—ã¦é‘‘å®šæ–‡ã‚’ç”Ÿæˆ
  let reading = '';
  const apiType = PropertiesService.getScriptProperties().getProperty('AI_API_TYPE'); // 'chatgpt' or 'claude'
  
  if (apiType === 'claude') {
    reading = callClaude(promptData.content, orderData);
  } else {
    reading = callChatGPT(promptData.content, orderData);
  }
  
  // 4. ç”Ÿæˆã•ã‚ŒãŸé‘‘å®šæ–‡ã‚’ä¿å­˜
  saveReadingResult(orderId, reading);
  
  // 5. LINEã§é€ä¿¡
  sendToLine(orderData.lineId, reading);
  
  Logger.log('é‘‘å®šå®Œäº†: ' + orderId);
}
```

### Step 5ï¼šãƒˆãƒªã‚¬ãƒ¼è¨­å®š

#### Googleãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«è‡ªå‹•å®Ÿè¡Œ

```javascript
function onFormSubmit(e) {
  // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«è‡ªå‹•ã§é‘‘å®šã‚’ç”Ÿæˆ
  const orderId = e.namedValues['æ³¨æ–‡ID'][0]; // ãƒ•ã‚©ãƒ¼ãƒ ã®é …ç›®åã«åˆã‚ã›ã‚‹
  autoGenerateReading(orderId);
}
```

#### ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®š
1. Apps Scriptã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒˆãƒªã‚¬ãƒ¼ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œãƒˆãƒªã‚¬ãƒ¼ã‚’è¿½åŠ ã€
3. å®Ÿè¡Œã™ã‚‹é–¢æ•°ï¼š`onFormSubmit`
4. ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚½ãƒ¼ã‚¹ï¼šã€Œãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã€
5. ã‚¤ãƒ™ãƒ³ãƒˆã®ç¨®é¡ï¼šã€Œãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã€
6. ä¿å­˜

### Step 6ï¼šAPI Keyã®è¨­å®š

```javascript
// ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä¿å­˜ï¼ˆä¸€åº¦ã ã‘å®Ÿè¡Œï¼‰
function setApiKeys() {
  const scriptProperties = PropertiesService.getScriptProperties();
  
  // ã©ã¡ã‚‰ã®APIã‚’ä½¿ã†ã‹
  scriptProperties.setProperty('AI_API_TYPE', 'claude'); // 'chatgpt' or 'claude'
  
  // ChatGPTã®å ´åˆ
  scriptProperties.setProperty('OPENAI_API_KEY', 'your-openai-api-key-here');
  
  // Claudeã®å ´åˆ
  scriptProperties.setProperty('CLAUDE_API_KEY', 'your-claude-api-key-here');
  
  Logger.log('API Keyã®è¨­å®šå®Œäº†');
}
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œ

```
ãŠå®¢æ§˜
  â†“ Googleãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼ˆæ³¨æ–‡ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²ï¼‰
  â†“ ãƒˆãƒªã‚¬ãƒ¼ç™ºå‹•
Google Apps Script
  â†“ â‘  æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿å–å¾—
  â†“ â‘¡ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå–å¾—ï¼ˆai_promptsã‚·ãƒ¼ãƒˆï¼‰
  â†“ â‘¢ ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ç½®æ›
  â†“ â‘£ AI APIå‘¼ã³å‡ºã—ï¼ˆChatGPT/Claudeï¼‰
  â†“ â‘¤ é‘‘å®šæ–‡å—ä¿¡
  â†“ â‘¥ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜
  â†“ â‘¦ LINEé€ä¿¡
ãŠå®¢æ§˜ï¼ˆé‘‘å®šæ–‡å—ä¿¡ï¼‰
```

## ğŸ”§ æ¨å¥¨è¨­å®š

### Claude APIæ¨å¥¨ç†ç”±
âœ… é•·æ–‡ç”Ÿæˆã«å¼·ã„ï¼ˆ8000ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
âœ… æ·±ã„æ´å¯ŸãŒå¾—ã‚‰ã‚Œã‚‹
âœ… æ—¥æœ¬èªã®å“è³ªãŒé«˜ã„
âœ… ã‚³ã‚¹ãƒˆåŠ¹ç‡ãŒè‰¯ã„

### ChatGPT API
âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé€Ÿã„
âœ… å®‰å®šæ€§ãŒé«˜ã„
âœ… ä½¿ã„ã‚„ã™ã„

## ğŸ“ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ç®¡ç†

### æ—¢å­˜ã®txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ´»ç”¨
- prompt_FREE_001.txt
- prompt_PAID_5000.txt
- prompt_PAID_10000.txt
- prompt_PAID_30000.txt
- prompt_SUBSCRIPTION_MONTHLY.txt

ã“ã‚Œã‚‰ã®å†…å®¹ã‚’`GAS_ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ.gs`ã®å„é–¢æ•°ã«ã‚³ãƒ”ãƒšã—ã¦ãã ã•ã„ã€‚

### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ›´æ–°
1. txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
2. GASã®è©²å½“é–¢æ•°ã‚’æ›´æ–°
3. `importPrompts()`ã‚’å†å®Ÿè¡Œ
4. è‡ªå‹•çš„ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒæ›´æ–°ã•ã‚Œã¾ã™

## âœ… å®Œæˆï¼

ã“ã‚Œã§å®Œå…¨è‡ªå‹•é‘‘å®šã‚·ã‚¹ãƒ†ãƒ ãŒå®Œæˆã—ã¾ã™ï¼

## ğŸ†˜ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒé•·ã™ãã¦GASã«å…¥ã‚‰ãªã„å ´åˆ
â†’ Google Driveã«txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦GASã§èª­ã¿è¾¼ã‚€æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ï¼ˆåˆ¥é€”å®Ÿè£…ï¼‰

### APIå‘¼ã³å‡ºã—ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆ
â†’ ãƒ­ã‚°ã‚’ç¢ºèªï¼š`è¡¨ç¤º` â†’ `ãƒ­ã‚°`

### é‘‘å®šæ–‡ãŒé€”ä¸­ã§åˆ‡ã‚Œã‚‹å ´åˆ
â†’ `max_tokens`ã‚’å¢—ã‚„ã™

## ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’GASã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
2. API Keyã‚’è¨­å®š
3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
4. æœ¬ç•ªé‹ç”¨é–‹å§‹

å…¨è‡ªå‹•é‘‘å®šã‚·ã‚¹ãƒ†ãƒ ã®å®Œæˆã§ã™ï¼ğŸ‰






