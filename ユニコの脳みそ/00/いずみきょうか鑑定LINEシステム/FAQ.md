---
tags: [FAQ, Troubleshooting, IzumiKyoka, 00]
date: 2026-01-20
source: ユニコの脳みそ/00
aliases: [FAQ, IzumiKyoka_FAQ]
---

[[00_知識マップ]]

# よくある質問（FAQ）

占い師用LINEメールステップ配信システムに関するよくある質問をまとめました。

---

## 基本的な質問

### Q1. このシステムは無料で使えますか？

**A**: はい、完全無料です。以下のGoogleサービスを使用しています：
- Google スプレッドシート（無料）
- Google Apps Script（無料）
- Gmail（無料プラン：1日500通まで）

ただし、以下の場合は有料プランの検討が必要です：
- 1日500通を超える送信が必要な場合 → Google Workspace（有料）または外部メール配信サービス
- より高度な機能が必要な場合 → SendGrid等の外部サービス

### Q2. プログラミングの知識は必要ですか？

**A**: 基本的な運用には不要です：
- **不要な作業**: 日常的な運用（ユーザー登録、申込み処理、メール確認）
- **あると便利**: テンプレートの編集、設定の変更
- **必要な作業**: システムのカスタマイズ（配信タイミングの変更、新機能の追加）

セットアップは「セットアップガイド.md」に従えば、コピー＆ペーストで完了します。

### Q3. 何人まで対応できますか？

**A**: 
- **ユーザー数**: 無制限（スプレッドシートの行数上限：約500万行）
- **1日の送信数**: Gmail無料版で500通まで
  - Google Workspace（有料）: 2,000通/日
  - 外部サービス（SendGrid等）: 制限なし（有料）

**目安：**
- 無料版：50〜100人の同時運用
- 有料版：200〜500人の同時運用

### Q4. LINEと連携できますか？

**A**: はい、以下の方法で連携可能です：

**方法1: プロラインフリー（推奨）**
- プロラインのアンケート機能で申込みフォームを作成
- Googleフォーム経由でスプレッドシートに連携
- 設定が簡単で初心者向け

**方法2: LINE Messaging API（上級者向け）**
- Webhookでメッセージを受信
- GAS側で自動処理
- プログラミング知識が必要

**方法3: 手動連携**
- LINEで受付 → 手動でスプレッドシートに入力
- プログラミング不要だが手間がかかる

詳細は「カスタマイズガイド.md」を参照してください。

### Q5. 実際にメールを送信するのに何分かかりますか？

**A**: 
- **トリガー実行**: 毎分自動実行
- **処理時間**: 通常10秒〜30秒
- **送信開始**: 申込みから1〜2分以内

例：
- 10:00:00 にユーザーが申込み
- 10:01:00 に tick() が実行される
- 10:01:15 にメール送信完了

ほぼリアルタイムで自動化されています。

---

## セットアップに関する質問

### Q6. セットアップでエラーが出ます

**症状別の対処法：**

#### 「承認が必要です」が表示される
- **原因**: 初回実行時の権限承認
- **対処**: 「権限を確認」→「詳細」→「安全ではないページに移動」→「許可」をクリック

#### 「TEMPLATE_NOT_FOUND」エラー
- **原因**: テンプレートが見つからない
- **対処**: `setupSheets()` を再実行して初期テンプレートを投入

#### トリガーが設定されない
- **原因**: 権限不足またはスクリプトエラー
- **対処**: 
  1. Apps Scriptエディタで「実行数」を確認
  2. エラーメッセージを確認
  3. `deleteTriggers()` → `setupTriggers()` を再実行

#### シートが作成されない
- **原因**: スクリプトの実行が中断された
- **対処**: 
  1. 既存のシートを削除
  2. `setupSheets()` を再実行

### Q7. テストメールが届きません

**チェックリスト：**

1. **config シートの確認**
   - [ ] `freeze_all = FALSE`
   - [ ] `freeze_sending = FALSE`
   - [ ] `preview_mode = TRUE`
   - [ ] `preview_to` にあなたのメールアドレスが設定されている

2. **トリガーの確認**
   - [ ] Apps Scriptの「トリガー」に `tick` が表示されている
   - [ ] エラーが発生していない

3. **send_queue の確認**
   - [ ] `status = pending` の行がある
   - [ ] `scheduled_at` が現在時刻より前になっている
   - [ ] エラーメッセージが無い

4. **迷惑メールフォルダを確認**
   - [ ] Gmailの迷惑メールフォルダに振り分けられていないか

5. **ログの確認**
   - [ ] `logs_[今月]` シートにエラーが記録されていないか

### Q8. プレビューモードを解除したのに、まだプレビュー宛に送信されます

**原因と対処：**

1. **スプレッドシートの保存確認**
   - `config` シートで `preview_mode = FALSE` に変更後、Ctrl+S で保存
   - ブラウザをリロード

2. **キャッシュの問題**
   - GASのキャッシュが残っている可能性
   - 対処：数分待ってから再試行

3. **既存キューの処理**
   - `preview_mode = TRUE` の時に追加されたキューは、モード変更後もプレビュー宛に送信される
   - 対処：`send_queue` で該当行を削除または `status = cancelled` に変更

---

## 運用に関する質問

### Q9. 1日に何通まで送信できますか？

**A**: 
- **Gmail 無料版**: 500通/日
- **Google Workspace**: 2,000通/日
- **外部サービス（SendGrid等）**: 制限なし（有料プランによる）

**計算例（無料版の場合）：**
- 1ユーザーあたり平均2通/日
- 同時運用可能人数：約100人

**制限超過の対処法：**
1. 複数のGmailアカウントを使用
2. Google Workspace（有料）に移行
3. SendGrid等の外部サービスを統合（「カスタマイズガイド.md」参照）

### Q10. メールが迷惑メールに振り分けられます

**対処法：**

1. **SPF/DKIM設定（推奨）**
   - 独自ドメインを使用している場合
   - Gmail/Google WorkspaceのSPF/DKIM設定を確認
   - DNS設定で認証情報を追加

2. **送信元の信頼性向上**
   - 定期的な送信（不規則な大量送信は避ける）
   - 配信停止リンクの追加
   - スパム的な言葉を避ける（「無料」「今すぐ」等の乱用）

3. **ユーザーへの案内**
   - 登録時に「メールが届かない場合は迷惑メールフォルダを確認してください」と案内
   - Gmail の場合：送信者を連絡先に追加してもらう

4. **テンプレートの見直し**
   - 過度な装飾（HTML）を避ける
   - 外部リンクを最小限に
   - 画像の埋め込みは避ける

### Q11. ユーザーが「メールが届かない」と言っています

**確認手順：**

1. **send_queue シートで確認**
   - 該当ユーザーのメールが `status = sent` になっているか
   - `sent_at` の日時を確認

2. **users シートで確認**
   - メールアドレスが正しく登録されているか
   - タイプミスがないか
   - `unsubscribed` が `FALSE` になっているか

3. **ログで確認**
   - `logs_[今月]` シートでエラーが無いか確認
   - 「送信成功」のログがあるか確認

4. **ユーザー側の確認依頼**
   - 迷惑メールフォルダを確認
   - メールアドレスが正しいか再確認
   - 受信拒否設定がないか確認

5. **再送信**
   - 必要に応じて手動で再送信
   - `send_queue` に新しい行を追加

### Q12. 配信を一時停止したい

**方法1: 全停止（推奨）**

`config` シートで `freeze_all = TRUE` に設定

→ すべての自動処理が停止

**方法2: 送信のみ停止**

`config` シートで `freeze_sending = TRUE` に設定

→ ユーザー宛の送信は停止、運営通知は継続

**方法3: トリガーを削除**

Apps Scriptエディタの「トリガー」から `tick` を削除

→ 完全停止（再開時は `setupTriggers()` を実行）

### Q13. 特定のユーザーへの配信を停止したい

**方法1: 配信停止フラグ**

`users` シートで該当ユーザーの `unsubscribed` を `TRUE` に変更

→ 今後すべての自動配信が停止

**方法2: 送信キューから削除**

`send_queue` で該当ユーザーの pending キューを `cancelled` に変更

→ 現在スケジュールされているメールのみ停止

**方法3: 手動で個別対応**

状況に応じて柔軟に対応してください。

---

## カスタマイズに関する質問

### Q14. 送信時刻を変更したい

**A**: 「カスタマイズガイド.md」の「配信タイミングの変更」セクションを参照してください。

主な変更箇所：
- 選定通知（正午）: `getNextNoonTime_()` 関数
- 結果メール（夜帯）: `handleAcceptedApplication_()` 関数内の時刻計算
- リマインダー: `scheduleReminders_()` 関数

### Q15. 新しいメールテンプレートを追加したい

**A**: 
1. `email_templates` シートに新しい行を追加
2. `template_id`, `name`, `subject`, `body` を入力
3. コード内で該当テンプレートIDを指定して送信

詳細は「カスタマイズガイド.md」の「新しいメールテンプレートの追加」を参照。

### Q16. 無料鑑定の期限を7日から変更したい

**A**: `Code.gs` の `judgeApplication_()` 関数を編集：

```javascript
if (daysSinceReg > 7) {  // ← この数値を変更
  return 'NG_EXPIRED_7DAYS';
}
```

例えば14日にする場合：

```javascript
if (daysSinceReg > 14) {
  return 'NG_EXPIRED_14DAYS';
}
```

### Q17. HTML形式のメールを送信したい

**A**: 
1. `email_templates` シートで `is_html` を `TRUE` に設定
2. `body` 列にHTMLコードを記述

```html
<!DOCTYPE html>
<html>
<body>
  <h1>{{name}}様</h1>
  <p>メール本文</p>
  <a href="{{link}}">リンク</a>
</body>
</html>
```

詳細は「カスタマイズガイド.md」を参照。

### Q18. LINE Messaging API と連携したい

**A**: Webhook方式（doPost）を実装する必要があります。

詳細は「カスタマイズガイド.md」の「Webhook連携」セクションを参照してください。

---

## トラブルシューティング

### Q19. 「Service invoked too many times」エラーが出ます

**原因**: Gmailの送信制限（500通/日）に達した

**対処法：**
1. 翌日まで待つ
2. 複数のGmailアカウントに分散
3. Google Workspace（有料）に移行
4. 外部メール配信サービス（SendGrid等）を統合

**予防策：**
- 送信数を監視（`kpi_daily` シートで記録）
- 余裕を持った配信計画（1日450通以内に抑える）

### Q20. リマインダーが送信されません

**確認手順：**

1. **appointments シートの確認**
   - 予約が正しく記録されているか
   - `appt_time` の日時が正しいか

2. **send_queue の確認**
   - リマインダーのキューが追加されているか（`template_id = tmpl_appt_rem1/2/3`）
   - `scheduled_at` の日時が正しいか
   - `status` が `pending` になっているか

3. **logs の確認**
   - リマインダーのスケジュール実行ログがあるか
   - エラーが発生していないか

**対処法：**
- キューが無い場合：`consult_decisions` の `processed` を `FALSE` に戻して再処理
- 手動で追加：`send_queue` に直接リマインダーを追加

### Q21. テンプレート変数が置換されません

**症状例：** メール本文に `{{name}}` がそのまま表示される

**原因と対処：**

1. **variables のJSON形式が正しくない**
   
   **NG：**
   ```
   {name: 'ユーザー名'}
   ```
   
   **OK：**
   ```json
   {"name":"ユーザー名"}
   ```
   
   ダブルクォートを使用してください。

2. **変数名が一致していない**
   
   テンプレート：`{{user_name}}`
   variables：`{"name":"ユーザー名"}`
   
   → 変数名を一致させる：`{"user_name":"ユーザー名"}`

3. **users シートの情報が不足**
   
   `users` シートの `name` 列が空の場合、自動的に置換されません。
   
   → `name` 列に氏名を入力

### Q22. メールが重複して送信されます

**原因：**
1. `processed` フラグが正しく更新されていない
2. 同じキューが複数回追加されている
3. トリガーが重複している

**対処法：**

1. **processed フラグの確認**
   - `applications` シートで `processed` が `TRUE` になっているか確認

2. **send_queue の重複確認**
   - 同じ `recipient` と `template_id` のキューが複数ないか確認
   - 重複している場合は片方を `cancelled` に変更

3. **トリガーの確認**
   - Apps Scriptエディタの「トリガー」を確認
   - `tick` が複数無いか確認
   - 重複している場合は削除（`deleteTriggers()` → `setupTriggers()`）

---

## データ管理に関する質問

### Q23. データのバックアップはどうすれば良いですか？

**推奨方法：**

**方法1: 手動バックアップ（週1回）**
1. スプレッドシートのメニューから「ファイル」→「コピーを作成」
2. 日付を付けて保存（例：「占いステップ_バックアップ_2025-11-03」）
3. 専用フォルダに整理

**方法2: バージョン履歴（自動）**
1. 「ファイル」→「バージョン履歴」→「バージョン履歴を表示」
2. 任意の時点に復元可能
3. 30日間保持される

**方法3: 外部エクスポート**
1. 各シートをCSV形式でエクスポート
2. 外部ストレージ（Dropbox等）に保存

### Q24. ログを削除しても大丈夫ですか？

**A**: はい、古いログは削除しても問題ありません。

**推奨：**
- 月次でアーカイブ：前月のログを別スプレッドシートに移動
- 3ヶ月以上前のログは削除してOK

**手順：**
1. `logs_[前月]` シートをコピー
2. アーカイブ用スプレッドシートに貼り付け
3. 元のシートを削除

ログが肥大化するとスプレッドシートが重くなるため、定期的な整理を推奨します。

### Q25. 古い送信キューを削除したい

**A**: `send_queue` シートが肥大化した場合、古いキューを削除できます。

**安全な削除対象：**
- `status = sent` かつ `sent_at` が30日以上前
- `status = error` または `cancelled` で対処済み

**手順：**
1. `send_queue` シートを開く
2. フィルタ機能で該当行を抽出
3. 行を選択して削除

**注意：** `status = pending` は削除しないでください（未送信のメールです）。

---

## その他の質問

### Q26. 複数の占い師で運用できますか？

**A**: はい、可能です。

**方法1: 1つのシステムで管理**
- `users` シートに `assigned_reader` 列を追加
- 担当占い師ごとに処理を分岐

**方法2: 占い師ごとにシステムを複製**
- スプレッドシート全体をコピー
- それぞれ独立して運用

どちらの方法も実装可能ですが、方法2の方が簡単です。

### Q27. スマートフォンから操作できますか？

**A**: 基本的な操作は可能です。

**可能な操作：**
- ユーザー情報の確認・編集
- 申込みの追加
- 送信キューの確認
- ログの確認

**難しい操作：**
- Apps Scriptの編集
- トリガーの設定
- 大規模なデータ編集

推奨：セットアップとカスタマイズはPCで、日常運用はスマートフォンでも可能。

### Q28. 英語版に対応できますか？

**A**: はい、テンプレートを英語に差し替えるだけで対応可能です。

**手順：**
1. `email_templates` シートの `subject` と `body` を英語に翻訳
2. エラーメッセージも必要に応じて英語化（コード編集が必要）

多言語対応したい場合は、言語ごとにテンプレートセットを用意し、ユーザーの `language` 列に応じて切り替える実装も可能です。

### Q29. 他の占い師にこのシステムを共有しても良いですか？

**A**: はい、自由に共有していただいて構いません。

このシステムはオープンソース的に提供されています。改造・再配布も自由です。

ただし、以下の点にご注意ください：
- サポートは提供されません（自己責任で運用）
- 商用利用も可能ですが、利用者自身の責任で運用してください
- 著作権表示は残していただけると嬉しいです（任意）

### Q30. もっと詳しく学びたい場合は？

**A**: 以下のリソースを参照してください：

**公式ドキュメント：**
- [Google Apps Script 公式ドキュメント](https://developers.google.com/apps-script)
- [Google スプレッドシート ヘルプ](https://support.google.com/docs)

**学習サイト：**
- Udemy: GASの入門コース
- YouTube: GASチュートリアル動画
- Qiita: GASの技術記事

**コミュニティ：**
- Stack Overflow (タグ: google-apps-script)
- Teratail (GASの質問)

**本システムのドキュメント：**
- README.md: システム概要
- セットアップガイド.md: 詳細なセットアップ手順
- 運用マニュアル.md: 日常運用の手順
- カスタマイズガイド.md: 高度なカスタマイズ方法

---

## 質問がここにない場合

運営チームまでお問い合わせください：
- メール：[運営メールアドレス]
- LINE：[運営LINE ID]

または、GitHubのIssueで質問を投稿してください（もしリポジトリがある場合）。

**Happy Fortune Telling! 🔮✨**

