---
tags: [Setup, Quick_Start, IzumiKyoka, 00]
date: 2026-01-20
source: ユニコの脳みそ/00
aliases: [最速3分セットアップ, Quick_Setup_3min]
---

[[00_知識マップ]]

# 【最速】3分で完了するセットアップ方法

## 🎯 この方法なら3分で完成します

GASもコードも不要！スプレッドシートに直接入力するだけ。

---

## 📝 手順

### Step 1：シートを作成（30秒）

1. Googleスプレッドシートを開く
2. 下部の「+」をクリック
3. 新しいシート名を「ai_prompts」に変更

### Step 2：ヘッダーを入力（30秒）

A1セルから以下を入力（またはコピペ）：

```
A1: prompt_id
B1: prompt_type
C1: product_id
D1: title
E1: content
F1: active
G1: sort_order
H1: notes
```

### Step 3：基本データを入力（1分）

以下を各セルに入力：

#### 2行目（無料鑑定）
```
A2: prompt_free_001
B2: love_reading
C2: FREE_001
D2: 溺愛され体験無料鑑定プロンプト
E2: （次のステップで入力）
F2: TRUE
G2: 1
H2: 無料鑑定
```

#### 3行目（5000円鑑定）
```
A3: prompt_paid_5000
B3: love_reading
C3: PAID_5000
D3: 彼の本心リーディング鑑定プロンプト
E3: （次のステップで入力）
F3: TRUE
G3: 2
H3: 5000円鑑定
```

#### 4行目（10000円鑑定）
```
A4: prompt_paid_10000
B4: love_reading
C4: PAID_10000
D4: 溺愛スイッチ発動鑑定プロンプト
E4: （次のステップで入力）
F4: TRUE
G4: 3
H4: 10000円鑑定
```

#### 5行目（30000円鑑定）
```
A5: prompt_paid_30000
B5: love_reading
C5: PAID_30000
D5: 溺愛体質完全変換鑑定プロンプト
E5: （次のステップで入力）
F5: TRUE
G5: 4
H5: 30000円鑑定
```

#### 6行目（サブスク）
```
A6: prompt_subscription
B6: love_reading
C6: SUBSCRIPTION_MONTHLY
D6: 溺愛サポート月次配信プロンプト
E6: （次のステップで入力）
F6: TRUE
G6: 5
H6: サブスク配信
```

### Step 4：プロンプトを貼り付け（1分）

#### E2セルにプロンプトを入力

1. **E2セルをクリック**
2. **prompt_FREE_001.txt を開く**
3. **全文をコピー（Ctrl+A → Ctrl+C）**
4. **E2セルに貼り付け（Ctrl+V）**
5. **Enterキー**

#### 同じ手順で残りも：

- **E3セル** ← `prompt_PAID_5000.txt` の内容
- **E4セル** ← `prompt_PAID_10000.txt` の内容
- **E5セル** ← `prompt_PAID_30000.txt` の内容
- **E6セル** ← `prompt_SUBSCRIPTION_MONTHLY.txt` の内容

---

## ✅ 完成！

これで `ai_prompts` シートの準備完了です！

---

## 🤖 次：自動鑑定の設定

### GASで自動鑑定関数を追加（既存のCode.gsに追加）

以下のコードを `Code.gs` の最後に追加：

```javascript
/**
 * 商品IDからプロンプトを取得
 */
function getPromptByProductId(productId) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('ai_prompts');
  const data = sheet.getDataRange().getValues();
  
  for (let i = 1; i < data.length; i++) {
    if (data[i][2] === productId && data[i][5] === true) {
      return data[i][4]; // content列
    }
  }
  return null;
}

/**
 * AI APIで鑑定生成（ChatGPT）
 */
function generateReading(productId, customerData) {
  // プロンプトを取得
  const prompt = getPromptByProductId(productId);
  if (!prompt) return null;
  
  // プレースホルダーを置換
  let filledPrompt = prompt
    .replace(/{顧客名}/g, customerData.name || '')
    .replace(/{生年月日}/g, customerData.birthdate || '')
    .replace(/{性別}/g, customerData.gender || '')
    .replace(/{選択肢}/g, customerData.choice || '')
    .replace(/{彼の名前}/g, customerData.hisName || '')
    .replace(/{悩みの詳細}/g, customerData.problem || '');
  
  // ChatGPT API呼び出し
  const apiKey = PropertiesService.getScriptProperties().getProperty('OPENAI_API_KEY');
  const url = 'https://api.openai.com/v1/chat/completions';
  
  const payload = {
    model: 'gpt-4',
    messages: [{role: 'user', content: filledPrompt}],
    temperature: 0.7,
    max_tokens: 4000
  };
  
  const options = {
    method: 'post',
    contentType: 'application/json',
    headers: {'Authorization': 'Bearer ' + apiKey},
    payload: JSON.stringify(payload),
    muteHttpExceptions: true
  };
  
  const response = UrlFetchApp.fetch(url, options);
  const result = JSON.parse(response.getContentText());
  
  return result.choices[0].message.content;
}

/**
 * APIキー設定（一度だけ実行）
 */
function setOpenAIKey() {
  const apiKey = 'ここにChatGPT APIキーを入力';
  PropertiesService.getScriptProperties().setProperty('OPENAI_API_KEY', apiKey);
  SpreadsheetApp.getUi().alert('APIキーを設定しました！');
}
```

### API設定

1. `setOpenAIKey()` 関数内のAPIキーを入力
2. 実行
3. 完了！

---

## 🎉 全自動鑑定システム完成！

### テスト方法

```javascript
function testReading() {
  const customerData = {
    name: 'テスト太郎',
    birthdate: '1990-01-01',
    gender: '男性',
    choice: 'A'
  };
  
  const reading = generateReading('FREE_001', customerData);
  Logger.log(reading);
}
```

実行して、ログを確認してください！

---

## 💡 この方法のメリット

✅ GASファイルを複数作る必要なし
✅ プロンプトはスプレッドシートで管理
✅ 修正も簡単（E列を直接編集）
✅ 3分で完成

---

## 📚 必要なファイル

- `prompt_FREE_001.txt`
- `prompt_PAID_5000.txt`
- `prompt_PAID_10000.txt`
- `prompt_PAID_30000.txt`
- `prompt_SUBSCRIPTION_MONTHLY.txt`

これらをE列に貼り付けるだけ！

---

**これが最速の方法です！** 🚀





